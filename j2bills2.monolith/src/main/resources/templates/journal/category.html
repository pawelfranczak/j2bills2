<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity3">

<head th:replace="/../general.html :: head"></head>

<body id="page-top">

	<script>
		function toggle(categoryOption) {
		
			let subCategoryOptions = document.getElementById("subCategory")
			
			for(i = 1; i < subCategoryOptions.length; i++) {
		       	subCategoryOption = subCategoryOptions[i];
		       	subCategoryOption.selected = false
				let hidden = subCategoryOption.getAttribute('hidden') !== null
				let parentCategory = subCategoryOption.getAttribute("parent-category")
				
				if (categoryOption.value == parentCategory) {
					if (hidden) {
						subCategoryOption.removeAttribute("hidden");
					}
				} else {
					if (!hidden) {
						subCategoryOption.setAttribute("hidden", "hidden");
					}
				}
			}
		}
	</script>

  <!-- Page Wrapper -->
  <div id="wrapper">

    <div th:insert="/../general.html :: sidebar"></div>

    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">

      <!-- Main Content -->
      <div id="content">

        <div th:insert="/../general.html :: topbar"></div>

        <!-- Begin Page Content -->
        <div class="container-fluid">

          <!-- Page Heading -->
          <div class="card shadow mb-4">
            <div class="card-header py-3">
              <h6 class="m-0 font-weight-bold text-primary">Modyfikuj kategorię</h6>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                  <thead>
                    <tr>
						<th>ID</th>
						<th>L.p.</th>
						<th>Użytkownik</th>
						<th>Konto</th>
						<th>Opis</th>
						<th>Wartość</th>
						<th>Balans na koncie przed wpisem</th>
						<th>Data</th>
                    </tr>
                  </thead>
                  <tbody>
					<th:block>
						<tr>
							<td><p th:text="${journalEntry.id}"></p></td>
							<td><p th:text="${journalEntry.sequence}"></p></td>
							<td><a th:href="'/user/' + @{${journalEntry.user.id}}"><p th:text="${journalEntry.user.firstName}"></p></a></td>
							<td><a th:href="'/account/' + @{${journalEntry.account.id}}"><p th:text="${journalEntry.account.name}"></p></a></td>
							<td><p th:text="${journalEntry.description}"></p></td>
							<td><p th:text="${journalEntry.value}"></p></td>
							<td><p th:text="${journalEntry.balanceOfAccountBeforeChange}"></p></td>
							<td><p th:text="${journalEntry.date}"></p></td>
						</tr>
					</th:block>
                  </tbody>
                </table>
                
                <form role="form" th:action="@{/journal/category}" th:method="post"	th:object="${journal}">
                
             		<div class="input-group">
						<select id="category" name="category" class="form-control" onchange="toggle(this)">
							<option value="">Select Category</option>
							<option th:each="category : ${categories}"
								th:value="${category.id}"
								th:text="${category.name}"
								th:selected="(${categoryID} == ${category.id})"
								></option>
						</select>
						<!--  <p th:if="${#fields.hasErrors('category')}"
							th:errors="*{category}">Category Error</p> -->
					</div>

					<BR>

					<div class="input-group">
						<select id="subCategory" name="subCategory" class="form-control">
							<option value="">Select SubCategory</option>
							<option th:each="subCategory : ${subCategories}"
								th:value="${subCategory.id}"
								th:text="${subCategory.name}"
								th:attr="parent-category=${subCategory.category.id}"
								th:selected="(${subCategoryID} == ${subCategory.id})" 
								hidden="hidden"></option>
						</select>
						<!--  <p th:if="${#fields.hasErrors('subCategory')}"
							th:errors="*{subCategory}">SubCategory Error</p> -->
					</div>
					
					<input type="hidden" name="id" th:value="${id}" />
					
					<BR> <input type="submit" class="btn btn-primary"> <BR>
					<BR>
				</form>
                
              </div>
            </div>
          </div>
          

        </div>
        <!-- /.container-fluid -->

      </div>
      <!-- End of Main Content -->

      <!-- Footer -->
      <footer th:insert="/../general.html :: footer"> </footer>
      <!-- End of Footer -->

    </div>
    <!-- End of Content Wrapper -->

  </div>
  <!-- End of Page Wrapper -->


  <!-- Logout Modal-->
  <div th:insert="/../general.html :: end-of-body"></div>

</body>

</html>
